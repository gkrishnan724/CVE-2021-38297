// Create and connect to the SQLite database
const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('./DB/twitter.db'); // Replace ':memory:' with the path to your database file

db.serialize(() => {
    db.run(`CREATE TABLE IF NOT EXISTS Users (
      id INTEGER PRIMARY KEY,
      password TEXT,
      name TEXT UNIQUE
    )`);
  
    db.run(`CREATE TABLE IF NOT EXISTS Posts (
      post_id INTEGER PRIMARY KEY,
      post_content TEXT,
      author_id INTEGER,
      FOREIGN KEY(author_id) REFERENCES Users(id)
    )`);
  
    db.run(`CREATE TABLE IF NOT EXISTS Comments (
      comment_id INTEGER PRIMARY KEY,
      comment_content TEXT,
      author_id INTEGER,
      post_id INTEGER,
      FOREIGN KEY(author_id) REFERENCES Users(id),
      FOREIGN KEY(post_id) REFERENCES Posts(post_id)
    )`);

    db.run(`INSERT INTO Users (id, password, name) VALUES (1, 'Iattack', 'attacker')`, (err) => {
      if (err) {
        console.error(err.message);
      } else {
        console.log("Attacker user added");
      }
    });
  
    db.run(`INSERT INTO Users (id, password, name) VALUES (2, 'amazon', 'amazon')`, (err) => {
      if (err) {
        console.error(err.message);
      } else {
        console.log("Amazon user added");
      }
    });

    db.run(`INSERT INTO Posts (post_content, author_id) VALUES ('Hello world', 1)`, (err) => {
      if (err) {
        console.error(err.message);
      } else {
        console.log("Post 1 added");
      }
    });
});